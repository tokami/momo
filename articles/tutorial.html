<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fine-scale movement modeling based on tagging data • momo</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fine-scale movement modeling based on tagging data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">momo</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/momo.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/tutorial.html">Fine-scale movement modeling based on tagging data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news">
<li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/tokami/momo/blob/main/momo/NEWS.md">Version 0.0.0.9000</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tokami/momo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fine-scale movement modeling based on tagging data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/tokami/momo/blob/HEAD/vignettes/tutorial.Rmd" class="external-link"><code>vignettes/tutorial.Rmd</code></a></small>
      <div class="d-none name"><code>tutorial.Rmd</code></div>
    </div>

    
    
<p>This tutorial illustrates the application of the <em>momo</em>
package to model fine-scale movement based on tagging data.</p>
<p><strong>Outline:</strong></p>
<ol style="list-style-type: decimal">
<li>Prepare the data</li>
<li>Fit the model</li>
<li>Results</li>
<li>Advanced settings</li>
<li>Summary</li>
<li>References</li>
</ol>
<p>The package is loaded into the R environment with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tokami/momo" class="external-link">momo</a></span><span class="op">)</span></span></code></pre></div>
<p>This introductory tutorial uses a simulated data set included in the
package: “skjepo”. We load it into the R environment with the command
<code>data(skjepo)</code>.</p>
<p>This command loads not only the main list object <code>skjepo</code>
(of class <code>momo.sim</code>), which contains all required simulated
data and can be used right away to fit the model, but also four
individual data sets: <code>skjepo.grid</code>, <code>skjepo.env</code>,
<code>skjepo.ctags</code>, and <code>skjepo.atags</code>. These data
sets illustrate the typical structure of raw input data and demonstrate
how the functions in the <em>momo</em> package can be used to convert
them into the format required by the model as demonstrated in the next
section.</p>
<div class="section level2">
<h2 id="prepare-the-data">
<em>Prepare the data</em><a class="anchor" aria-label="anchor" href="#prepare-the-data"></a>
</h2>
<p>The package provides two main data sets: one with information on
releases and recoveries of conventional tags, and another with track
data from archival tags. These data sets can be prepared for analysis
using the built-in functions <code>prep.ctags</code> and
<code>prep.atags</code>. Both functions allow users to specify which
columns contain the release and recapture times and locations, and
automatically convert date fields to the required format. Additional
features, such as a speed filter to flag implausible movements, are also
available. For full details on how to use each function, refer to their
respective help pages (e.g., <code><a href="../reference/prep.ctags.html">help("prep.ctags")</a></code>).</p>
<pre><code><span><span class="co">#&gt; Removing 5 recaptured tags for which release time is after recapture time (t0 &gt; t1).</span></span></code></pre>
<p><img src="tutorial_files/figure-html/unnamed-chunk-3-1.png" alt="Mark-recapture and archival tags" width="768"><img src="tutorial_files/figure-html/unnamed-chunk-3-2.png" alt="Mark-recapture and archival tags" width="768"></p>
<p>Based on the spatial extent of the tagging data, the next step is to
define a spatial grid. While the Kalman filter approach does not require
a grid for model fitting <span class="citation">(Mildenberger, Maunder,
and Nielsen in prep)</span>, using a grid enables spatial prediction,
visualization, and analysis of estimated habitat preferences and
movement rates. The <code>create.grid</code> function offers flexible
functionality to define custom grids and to manually include or exclude
specific grid cells as needed.</p>
<p>Since manual selection of grid cells is not feasible in this
automated vignette, we use the grid provided in the skjepo data set, but
modify it to create a coarser resolution:</p>
<p><img src="tutorial_files/figure-html/unnamed-chunk-5-1.png" alt="Spatial grid" width="768"></p>
<p>Another important component of <em>momo</em> is the environmental
data, which characterizes the habitat preferences of the modeled
species. The <code>prep.env</code> function formats this data into the
structure required by the model:</p>
<p><img src="tutorial_files/figure-html/unnamed-chunk-6-1.png" alt="First four environmental fields" width="768"></p>
<p>To speed up the fitting process in this vignette, we use a subset of
the available conventional tag data:</p>
<p>The individual data sets can then be combined into a single input
object using the <code>setup.momo.data</code> function.</p>
<p>The <code>def.conf</code> function generates a list of default
configuration settings, including flags that control which model
functionalities are activated and how environmental fields are aligned
with the model’s time steps. It is good practice to review this
configuration list to ensure that the default settings align with the
goals and structure of your analysis.</p>
<p>Similarly, the <code>def.par</code> function generates a list of
default model parameters and their initial values. While users can
adjust the initial values as needed, caution is required when modifying
parameter dimensions. These dimensions must be consistent with the input
data (e.g., the number of environmental fields) and the configuration
settings (e.g., whether passive advection, taxis, or both are used).</p>
<p>With all necessary input data prepared, the model is now ready to be
fitted using <em>momo</em>.</p>
</div>
<div class="section level2">
<h2 id="fit-the-model">
<em>Fit the model</em><a class="anchor" aria-label="anchor" href="#fit-the-model"></a>
</h2>
<p>The model is fitted using the <code>fit.momo</code> function.
Depending on the model’s complexity and the number of tags, this step
may take several minutes. To reduce computation time, we disable the
calculation of uncertainty estimates by setting
<code>do.sdreport = FALSE</code>.</p>
<pre><code><span><span class="co">#&gt; Building the model, that can take a few minutes.</span></span>
<span><span class="co">#&gt; Model built (0.38min). Minimizing neg. loglik.</span></span>
<span><span class="co">#&gt;   0:     1595143.9:  0.00000  0.00000 -4.60517 -4.60517</span></span>
<span><span class="co">#&gt;   1:     635104.70: -0.00109162 0.00103431 -3.80611 -4.00393</span></span>
<span><span class="co">#&gt;   2:     304398.49: -0.00321421 0.00304836 -3.65852 -3.01488</span></span>
<span><span class="co">#&gt;   3:     170499.70: -0.0452335 0.0429272 -3.57747 -2.01986</span></span>
<span><span class="co">#&gt;   4:     69216.328: -0.0488214 0.0463318 -2.68219 -1.57439</span></span>
<span><span class="co">#&gt;   5:     39735.044: -0.0693510 0.0658124 -1.74462 -1.92105</span></span>
<span><span class="co">#&gt;   6:     16219.655: -0.0717639 0.0681009 -0.957443 -1.30433</span></span>
<span><span class="co">#&gt;   7:     8947.6279: -0.0944541 0.0896236 0.0237874 -1.49461</span></span>
<span><span class="co">#&gt;   8:     5023.3234: -0.0783233 0.0743135 0.700975 -0.759138</span></span>
<span><span class="co">#&gt;   9:     3583.2798: -0.0822662 0.0780472  1.69448 -0.872793</span></span>
<span><span class="co">#&gt;  10:     3081.8592: -0.0855251 0.0811369  2.56455 -1.36571</span></span>
<span><span class="co">#&gt;  11:     3051.9565: -0.293328 0.277865  2.56205 -2.32389</span></span>
<span><span class="co">#&gt;  12:     3044.8443: -0.848239 0.802450  3.03697 -2.76131</span></span>
<span><span class="co">#&gt;  13:     3012.0243: -1.17703  1.11384  2.85028 -2.66093</span></span>
<span><span class="co">#&gt;  14:     3010.1656: -1.53914  1.45674  2.81434 -2.66349</span></span>
<span><span class="co">#&gt;  15:     3007.8178: -2.82995  2.67935  2.79499 -2.69077</span></span>
<span><span class="co">#&gt;  16:     2999.9149: -7.99253  7.57087  2.75921 -2.80270</span></span>
<span><span class="co">#&gt;  17:     2976.7818: -27.8526  26.3966  2.68642 -3.23978</span></span>
<span><span class="co">#&gt;  18:     2946.0280: -60.1889  57.0742  2.64521 -4.00469</span></span>
<span><span class="co">#&gt;  19:     2913.7132: -112.051  106.308  2.65744 -5.32466</span></span>
<span><span class="co">#&gt;  20:     2905.8012: -121.241  115.077  2.71608 -5.61794</span></span>
<span><span class="co">#&gt;  21:     2904.0295: -121.952  115.825  2.76101 -5.68303</span></span>
<span><span class="co">#&gt;  22:     2904.0208: -121.797  115.724  2.76409 -5.68283</span></span>
<span><span class="co">#&gt;  23:     2904.0198: -121.738  115.717  2.76436 -5.68219</span></span>
<span><span class="co">#&gt;  24:     2904.0081: -121.094  115.835  2.76634 -5.67661</span></span>
<span><span class="co">#&gt;  25:     2903.9865: -119.987  116.381  2.76854 -5.66987</span></span>
<span><span class="co">#&gt;  26:     2903.9253: -117.072  118.439  2.77231 -5.65739</span></span>
<span><span class="co">#&gt;  27:     2903.7655: -109.572  124.805  2.77852 -5.63446</span></span>
<span><span class="co">#&gt;  28:     2903.3677: -91.0385  142.337  2.78805 -5.59320</span></span>
<span><span class="co">#&gt;  29:     2902.3888: -45.8686  187.979  2.80182 -5.51761</span></span>
<span><span class="co">#&gt;  30:     2900.0575:  62.0671  301.698  2.81974 -5.37694</span></span>
<span><span class="co">#&gt;  31:     2895.2515:  289.507  548.648  2.83529 -5.14487</span></span>
<span><span class="co">#&gt;  32:     2887.5615:  663.247  966.839  2.83249 -4.88191</span></span>
<span><span class="co">#&gt;  33:     2878.3964:  1104.80  1483.86  2.80062 -4.81514</span></span>
<span><span class="co">#&gt;  34:     2872.4940:  1473.44  1944.38  2.75515 -5.08352</span></span>
<span><span class="co">#&gt;  35:     2872.1677:  1494.81  1981.95  2.74499 -5.22060</span></span>
<span><span class="co">#&gt;  36:     2872.1532:  1471.98  1955.95  2.74421 -5.23014</span></span>
<span><span class="co">#&gt;  37:     2872.1500:  1459.32  1940.98  2.74322 -5.22813</span></span>
<span><span class="co">#&gt;  38:     2872.1499:  1459.06  1940.54  2.74299 -5.22607</span></span>
<span><span class="co">#&gt;  39:     2872.1499:  1459.31  1940.78  2.74295 -5.22539</span></span>
<span><span class="co">#&gt;  40:     2872.1499:  1459.42  1940.90  2.74293 -5.22495</span></span>
<span><span class="co">#&gt;  41:     2872.1499:  1459.82  1941.31  2.74288 -5.22279</span></span>
<span><span class="co">#&gt;  42:     2872.1499:  1460.33  1941.85  2.74281 -5.21823</span></span>
<span><span class="co">#&gt;  43:     2872.1497:  1461.28  1942.84  2.74268 -5.20521</span></span>
<span><span class="co">#&gt;  44:     2872.1493:  1462.90  1944.53  2.74246 -5.17064</span></span>
<span><span class="co">#&gt;  45:     2872.1479:  1466.36  1948.12  2.74196 -5.06348</span></span>
<span><span class="co">#&gt;  46:     2872.1368:  1478.68  1960.88  2.74012 -4.59055</span></span>
<span><span class="co">#&gt;  47:     2870.9765:  1528.04  2011.87  2.73283 -2.65781</span></span>
<span><span class="co">#&gt;  48:     2870.8166:  1530.01  2013.91  2.72877 -2.58037</span></span>
<span><span class="co">#&gt;  49:     2870.4629:  1530.01  2013.91  2.70643 -2.58006</span></span>
<span><span class="co">#&gt;  50:     2869.8001:  1530.01  2013.92  2.68294 -2.22345</span></span>
<span><span class="co">#&gt;  51:     2869.6850:  1529.76  2013.66  2.67056 -2.22491</span></span>
<span><span class="co">#&gt;  52:     2869.6831:  1529.51  2013.40  2.66937 -2.22428</span></span>
<span><span class="co">#&gt;  53:     2869.5788:  1483.80  1966.14  2.67656 -2.26811</span></span>
<span><span class="co">#&gt;  54:     2869.5028:  1460.08  1939.75  2.66629 -2.19116</span></span>
<span><span class="co">#&gt;  55:     2869.4992:  1445.76  1923.06  2.66391 -2.18644</span></span>
<span><span class="co">#&gt;  56:     2869.4992:  1446.64  1924.07  2.66420 -2.18598</span></span>
<span><span class="co">#&gt;  57:     2869.4992:  1446.77  1924.23  2.66424 -2.18641</span></span>
<span><span class="co">#&gt;  58:     2869.4992:  1446.74  1924.19  2.66423 -2.18633</span></span>
<span><span class="co">#&gt; Minimization done (0.019min). Model converged. Estimating uncertainty.</span></span></code></pre>
<p>In addition to the input data lists, the returned object also
includes the <code>obj</code> (from RTMB) and <code>opt</code> (from the
minimizer). Both contain the estimated parameter values and other
details relevant to the model fitting.</p>
<pre><code><span><span class="co">#&gt;       alpha       alpha        beta logSdObsATS </span></span>
<span><span class="co">#&gt; 1446.738562 1924.188935    2.664225   -2.186326</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="results">
<em>Results</em><a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p><em>momo</em> provides several functions for visualizing model
results. In this example, since the data are simulated and the true
parameters are known, we can use the <code>plotmomo.compare</code>
function to visualize both the estimated and true habitat preferences
and movement patterns.</p>
<p><img src="tutorial_files/figure-html/unnamed-chunk-13-1.png" alt="Simulated data and model predictions" width="768"></p>
</div>
<div class="section level2">
<h2 id="advanced-settings">
<em>Advanced settings</em><a class="anchor" aria-label="anchor" href="#advanced-settings"></a>
</h2>
<p>There are several advanced settings in <em>momo</em> that will be
covered in future vignettes. However, this vignette highlights three
important ones: (i) grouping tags into release events to speed up model
fitting, (ii) using the matrix exponential approach as an alternative to
the Kalman filter, and (iii) mapping parameters to fix or exclude them
during estimation.</p>
<p>It is common for multiple tags to be released at the same location
and time. Grouping these tags into release events can significantly
speed up the movement modeling, as the analysis is performed per event
rather than per individual tag. The potential loss in accuracy is likely
minimal and can be evaluated through sensitivity analyses, while the
grouped approach is recommended for the baseline scenario due to its
efficiency. The <code>get.release.event</code> function enables this
grouping by assigning tags to release events based on a specified
spatial grid and time vector. These events can then be added to the data
list for modeling. Note that this is step is optional.</p>
<p>By default, <em>momo</em> uses the Kalman filter approach as
described in <span class="citation">Mildenberger, Maunder, and Nielsen
(in prep)</span>. However, it also supports an alternative method based
on the matrix exponential. You can easily switch between the two by
setting the <code>use.expm</code> flag in the configuration list. To use
the matrix exponential approach, simply set
<code>use.expm = TRUE</code>.</p>
<p>Lastly, it may be useful to map parameters, for example, to estimate
a single value for both directions of passive advection. A list of
default mapping settings can be generated using the <code>def.map</code>
function. The resulting map can then be passed to <code>fit.momo</code>
to control which parameters are estimated, fixed, or shared.</p>
</div>
<div class="section level2">
<h2 id="summary">
<em>Summary</em><a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>This vignette introduced the main features and workflow of the
<em>momo</em> package for estimating animal movement and habitat
preferences from tagging data. Using a simulated data set
(<code>skjepo</code>), we demonstrated how to prepare the required
inputs, configure and fit the model, and visualize the results.</p>
<p>We covered the preparation of conventional and archival tag data
(<code>prep.ctags</code>, <code>prep.atags</code>), environmental fields
(<code>prep.env</code>), and spatial grids (<code>create.grid</code>).
These were then combined using <code>setup.momo.data</code> into a
format suitable for model fitting. Configuration and parameter
initialization were handled through <code>def.conf</code> and
<code>def.par</code>, with model fitting performed using
<code>fit.momo</code>. The <code>plotmomo.compare</code> function
allowed us to visualize and compare estimated versus true movement and
habitat preference patterns.</p>
<p>Several advanced options were introduced, including grouping tags
into release events (<code>get.release.event</code>), switching between
the Kalman filter and matrix exponential approaches
(<code>use.expm</code> flag), and mapping parameters
(<code>def.map</code>) to simplify or constrain estimation.</p>
<p>This basic example provides a foundation for applying <em>momo</em>
to real tagging data. More details about the methodology are described
in <span class="citation">Mildenberger, Maunder, and Nielsen (in
prep)</span>. Further details about functions and their arguments can be
found in the help files of the functions (<code><a href="https://rdrr.io/r/utils/help.html" class="external-link">help()</a></code> or
<code>?</code>, where the dots refer to any function of the package).
Additional vignettes will explore uncertainty estimation, model
diagnostics, and sensitivity analyses to support more robust ecological
inference and management applications.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">
<em>References</em><a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-MildenbergerInPrep" class="csl-entry">
Mildenberger, Tobias Karl, Mark Maunder, and Anders Nielsen. in prep.
<span>“Momo: An r Package for the Estimation of Fine-Scale Animal
Movement Based on Tagging Data.”</span> <em>Methods in Ecology and
Evolution</em>, in prep.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/tokami" class="external-link">Tobias Mildenberger</a>, Mark Maunder, <a href="https://github.com/fishfollower" class="external-link">Anders Nielsen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
