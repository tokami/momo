<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit the movement model — fit.momo • momo</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the movement model — fit.momo"><meta name="description" content="The movement model, momo, allows estimation of habitat
preferences and fine-scale movement rates using various types of tagging
data. It supports flexible spatiotemporal modeling with options for
Kalman filter or matrix exponential approaches, and includes tools for
data preparation, model fitting, and visualization."><meta property="og:description" content="The movement model, momo, allows estimation of habitat
preferences and fine-scale movement rates using various types of tagging
data. It supports flexible spatiotemporal modeling with options for
Kalman filter or matrix exponential approaches, and includes tools for
data preparation, model fitting, and visualization."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">momo</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/momo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tutorial.html">Fine-scale movement modeling based on tagging data</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/tokami/momo/blob/main/momo/NEWS.md">Version 0.0.0.9000</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tokami/momo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit the movement model</h1>
      <small class="dont-index">Source: <a href="https://github.com/tokami/momo/blob/HEAD/R/fit.R" class="external-link"><code>R/fit.R</code></a></small>
      <div class="d-none name"><code>fit.momo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The movement model, momo, allows estimation of habitat
preferences and fine-scale movement rates using various types of tagging
data. It supports flexible spatiotemporal modeling with options for
Kalman filter or matrix exponential approaches, and includes tools for
data preparation, model fitting, and visualization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit.momo</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  conf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  map <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  run <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="get.lower.bounds.html">get.lower.bounds</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span>,</span>
<span>  upper <span class="op">=</span> <span class="fu"><a href="get.upper.bounds.html">get.upper.bounds</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span>,</span>
<span>  rel.tol <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  do.sdreport <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  do.report <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use.expm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use.rel.events <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dbg <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  control <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>data frame with input data as produced by the function
check.momo.data.</p></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>configuration list as produced by the function <a href="def.conf.html">def.conf</a>. If
<code>NULL</code> (default), <a href="def.conf.html">def.conf</a> is used to generate the default
configuration list based on the input data.</p></dd>


<dt id="arg-par">par<a class="anchor" aria-label="anchor" href="#arg-par"></a></dt>
<dd><p>parameter list with initial values as produced by the function
<a href="def.par.html">def.par</a>. If <code>NULL</code> (default), <a href="def.par.html">def.par</a> is used to generate the
default parameter list based on the input data and configuration list.</p></dd>


<dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>list with parameter mapping as produced by the function
<a href="def.map.html">def.map</a>. If <code>NULL</code> (default), <a href="def.map.html">def.map</a> is used to generate the
default mapping list based on the input data and configuration and
parameter lists.</p></dd>


<dt id="arg-run">run<a class="anchor" aria-label="anchor" href="#arg-run"></a></dt>
<dd><p>logical; If <code>FALSE</code>, the AD object is returned with the
optimization. Default: <code>FALSE</code>.</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>by default, <a href="get.lower.bounds.html">get.lower.bounds</a> is used.</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>by default, <a href="get.upper.bounds.html">get.upper.bounds</a> is used.</p></dd>


<dt id="arg-rel-tol">rel.tol<a class="anchor" aria-label="anchor" href="#arg-rel-tol"></a></dt>
<dd><p>option passed to <a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb</a> sets the convergence
criteria. Default: <code>1e-10</code>.</p></dd>


<dt id="arg-do-sdreport">do.sdreport<a class="anchor" aria-label="anchor" href="#arg-do-sdreport"></a></dt>
<dd><p>logical; If <code>FALSE</code>, <a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">RTMB::sdreport</a> is not run and no
parameter uncertainties are returned. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-do-report">do.report<a class="anchor" aria-label="anchor" href="#arg-do-report"></a></dt>
<dd><p>logical; If <code>FALSE</code>, <code>obj$report()</code> is not run and RTMB
variables might not be reported. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-use-expm">use.expm<a class="anchor" aria-label="anchor" href="#arg-use-expm"></a></dt>
<dd><p>logical; allows to overwrite setting in configuration list
(<code>conf$use.expm</code>). If <code>NULL</code>, setting from configuration list is used.
Default: <code>NULL</code>.</p></dd>


<dt id="arg-use-rel-events">use.rel.events<a class="anchor" aria-label="anchor" href="#arg-use-rel-events"></a></dt>
<dd><p>logical; allows to overwrite setting in configuration
list (<code>conf$use.rel.events</code>). If <code>NULL</code>, setting from configuration list
is used. Default: <code>NULL</code>.</p></dd>


<dt id="arg-dbg">dbg<a class="anchor" aria-label="anchor" href="#arg-dbg"></a></dt>
<dd><p>allows to run fit.momo in debugging mode. Default: <code>FALSE</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>if <code>TRUE</code>, print information to console. Default: <code>TRUE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>extra arguments to <a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">RTMB::MakeADFun</a>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>momo.fit</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">skjepo</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fit.momo</span><span class="op">(</span><span class="va">skjepo</span>, do.sdreport <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building the model, that can take a few minutes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model built (0.8min). Minimizing neg. loglik.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0:     682413.23:  0.00000  0.00000 -4.60517 -4.60517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:     274130.57: 0.00200891 -0.00117415 -3.69945 -4.18130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     132959.07: 0.00197270 -0.00115169 -2.76794 -4.54501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:     52328.431: 0.00228676 -0.00133323 -1.81275 -4.84101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:     21296.061: 0.00277104 -0.00161323 -0.981465 -5.39686</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:     9941.5062: 0.00469598 -0.00273318 -0.316932 -6.14411</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6:     5014.8354: 0.0326854 -0.0190535 0.287029 -6.94047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7:     3021.4091: 0.442958 -0.257921 0.818323 -7.64214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8:     2373.9455:  1.21661 -0.702660  1.22647 -7.83473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9:     2230.8701:  2.05764 -1.18264  1.47354 -7.87000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10:     2213.2060:  2.92339 -1.67450  1.56594 -7.87448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11:     2203.4125:  5.78530 -3.28752  1.60218 -7.87495</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12:     2181.3360:  14.8179 -8.28241  1.64366 -7.87255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  13:     2137.0165:  41.1654 -22.4755  1.67783 -7.86106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  14:     2107.1179:  67.8229 -36.0774  1.64417 -7.84623</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  15:     2096.0992:  81.0496 -41.5434  1.58008 -7.83725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  16:     2091.6096:  80.5125 -39.2545  1.53774 -7.83667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  17:     2089.6137:  79.7125 -37.0433  1.52168 -7.83745</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  18:     2084.2103:  80.4429 -29.8593  1.48319 -7.84024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  19:     2078.7623:  83.8732 -23.5050  1.46125 -7.84291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  20:     2058.2771:  101.762 -0.826740  1.40566 -7.85279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  21:     2009.6027:  162.051  61.3394  1.30008 -7.88049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22:     1961.4654:  226.671  118.990  1.25059 -7.90713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  23:     1870.2841:  371.426  235.847  1.24331 -7.96340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  24:     1829.2522:  451.112  297.080  1.33039 -7.99676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  25:     1821.5478:  481.850  315.389  1.38495 -8.00712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  26:     1820.5711:  488.731  314.998  1.39767 -8.00641</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  27:     1820.2548:  488.808  309.813  1.40040 -8.00298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  28:     1820.2085:  486.448  306.028  1.39900 -8.00064</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  29:     1820.2053:  485.294  305.007  1.39822 -8.00003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  30:     1820.2051:  485.030  304.873  1.39809 -7.99991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  31:     1820.2051:  485.018  304.877  1.39809 -7.99985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  32:     1820.2051:  485.018  304.877  1.39810 -7.99980</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimization done (0.096min). Model converged. Estimating uncertainty.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/tokami" class="external-link">Tobias Mildenberger</a>, <a href="https://www.populationassessment.com/" class="external-link">Mark Maunder</a>, <a href="https://github.com/fishfollower" class="external-link">Anders Nielsen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

