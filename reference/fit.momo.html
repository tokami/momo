<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit the movement model — fit.momo • momo</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the movement model — fit.momo"><meta name="description" content="The movement model, momo, allows estimation of habitat
preferences and fine-scale movement rates using various types of tagging
data. It supports flexible spatiotemporal modeling with options for
Kalman filter or matrix exponential approaches, and includes tools for
data preparation, model fitting, and visualization."><meta property="og:description" content="The movement model, momo, allows estimation of habitat
preferences and fine-scale movement rates using various types of tagging
data. It supports flexible spatiotemporal modeling with options for
Kalman filter or matrix exponential approaches, and includes tools for
data preparation, model fitting, and visualization."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">momo</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/momo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/tutorial.html">Fine-scale movement modeling based on tagging data</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://github.com/tokami/momo/blob/main/momo/NEWS.md">Version 0.0.0.9000</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tokami/momo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit the movement model</h1>
      <small class="dont-index">Source: <a href="https://github.com/tokami/momo/blob/HEAD/R/fit.R" class="external-link"><code>R/fit.R</code></a></small>
      <div class="d-none name"><code>fit.momo.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The movement model, momo, allows estimation of habitat
preferences and fine-scale movement rates using various types of tagging
data. It supports flexible spatiotemporal modeling with options for
Kalman filter or matrix exponential approaches, and includes tools for
data preparation, model fitting, and visualization.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit.momo</span><span class="op">(</span></span>
<span>  <span class="va">dat</span>,</span>
<span>  conf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  par <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  map <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  run <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="get.lower.bounds.html">get.lower.bounds</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span>,</span>
<span>  upper <span class="op">=</span> <span class="fu"><a href="get.upper.bounds.html">get.upper.bounds</a></span><span class="op">(</span><span class="va">par</span><span class="op">)</span>,</span>
<span>  rel.tol <span class="op">=</span> <span class="fl">1e-10</span>,</span>
<span>  do.sdreport <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  do.report <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use.expm <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use.rel.events <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>data frame with input data as produced by the function
check.momo.data.</p></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>configuration list as produced by the function <a href="def.conf.html">def.conf</a>. If
<code>NULL</code> (default), <a href="def.conf.html">def.conf</a> is used to generate the default
configuration list based on the input data.</p></dd>


<dt id="arg-par">par<a class="anchor" aria-label="anchor" href="#arg-par"></a></dt>
<dd><p>parameter list with initial values as produced by the function
<a href="def.par.html">def.par</a>. If <code>NULL</code> (default), <a href="def.par.html">def.par</a> is used to generate the
default parameter list based on the input data and configuration list.</p></dd>


<dt id="arg-map">map<a class="anchor" aria-label="anchor" href="#arg-map"></a></dt>
<dd><p>list with parameter mapping as produced by the function
<a href="def.map.html">def.map</a>. If <code>NULL</code> (default), <a href="def.map.html">def.map</a> is used to generate the
default mapping list based on the input data and configuration and
parameter lists.</p></dd>


<dt id="arg-run">run<a class="anchor" aria-label="anchor" href="#arg-run"></a></dt>
<dd><p>logical; If <code>FALSE</code>, the AD object is returned with the
optimization. Default: <code>FALSE</code>.</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>by default, <a href="get.lower.bounds.html">get.lower.bounds</a> is used.</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>by default, <a href="get.upper.bounds.html">get.upper.bounds</a> is used.</p></dd>


<dt id="arg-rel-tol">rel.tol<a class="anchor" aria-label="anchor" href="#arg-rel-tol"></a></dt>
<dd><p>option passed to <a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb</a> sets the convergence
criteria. Default: <code>1e-10</code>.</p></dd>


<dt id="arg-do-sdreport">do.sdreport<a class="anchor" aria-label="anchor" href="#arg-do-sdreport"></a></dt>
<dd><p>logical; If <code>FALSE</code>, <a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">RTMB::sdreport</a> is not run and no
parameter uncertainties are returned. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-do-report">do.report<a class="anchor" aria-label="anchor" href="#arg-do-report"></a></dt>
<dd><p>logical; If <code>FALSE</code>, <code>obj$report()</code> is not run and RTMB
variables might not be reported. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-use-expm">use.expm<a class="anchor" aria-label="anchor" href="#arg-use-expm"></a></dt>
<dd><p>logical; allows to overwrite setting in configuration list
(<code>conf$use.expm</code>). If <code>NULL</code>, setting from configuration list is used.
Default: <code>NULL</code>.</p></dd>


<dt id="arg-use-rel-events">use.rel.events<a class="anchor" aria-label="anchor" href="#arg-use-rel-events"></a></dt>
<dd><p>logical; allows to overwrite setting in configuration
list (<code>conf$use.rel.events</code>). If <code>NULL</code>, setting from configuration list
is used. Default: <code>NULL</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>if <code>TRUE</code>, print information to console. Default: <code>TRUE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>extra arguments to <a href="https://rdrr.io/pkg/RTMB/man/TMB-interface.html" class="external-link">RTMB::MakeADFun</a>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of class <code>momo.fit</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">skjepo</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">fit.momo</span><span class="op">(</span><span class="va">skjepo</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building the model, that can take a few minutes.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model built (0.99min). Minimizing neg. loglik.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0:     2024137.4:  0.00000  0.00000 -4.60517 -4.60517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:     822806.96: -0.00442984 0.00317523 -3.72887 -4.12343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:     429339.57: -0.0143688 0.0103040 -3.46755 -3.15826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:     214568.29: -0.414157 0.297082 -2.59723 -3.13659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:     100599.53: -0.417775 0.299686 -2.14436 -2.24503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:     45369.701: -0.419581 0.300984 -1.14453 -2.26330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6:     22178.448: -0.430474 0.308792 -0.673123 -1.38149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7:     10381.920: -0.429132 0.307830 0.326756 -1.36604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8:     7703.8075: -0.390426 0.280031 0.687032 -0.434410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9:     5160.7658: -0.400396 0.287180  1.67321 -0.599652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10:     4211.5318: -0.383993 0.275400  2.44868 -1.23071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11:     4115.4272: -1.09732 0.786486  2.53610 -1.70221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12:     4074.3916: -1.10233 0.790075  2.81142 -1.72440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  13:     4065.1856: -1.31075 0.939500  2.76596 -1.81660</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  14:     4056.6811: -1.50508  1.07884  2.82306 -1.94264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  15:     4008.7287: -7.10373  5.09377  2.81722 -2.24258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  16:     3888.0840: -28.7389  20.6409  2.74378 -2.92450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  17:     3797.7523: -61.7620  44.4425  2.70626 -3.92068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  18:     3788.9090: -73.9539  53.2874  2.72004 -4.31690</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  19:     3788.5840: -76.4753  55.1851  2.72451 -4.40093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  20:     3788.5758: -76.7968  55.4968  2.72488 -4.41174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  21:     3788.5708: -76.8688  55.6705  2.72514 -4.41479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22:     3788.5471: -76.9244  56.4203  2.72574 -4.42017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  23:     3788.4882: -76.5814  58.2710  2.72681 -4.41943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  24:     3788.3478: -75.0263  62.5283  2.72820 -4.39483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  25:     3787.9751: -69.7242  73.5093  2.73032 -4.29317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  26:     3786.9841: -53.7325  102.254  2.73306 -3.96372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  27:     3783.9822: -6.78135  180.581  2.73516 -2.96278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  28:     3782.1413:  12.1685  211.810  2.72170 -2.55314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  29:     3779.7960:  27.3465  236.562  2.62458 -2.22205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  30:     3778.6891:  34.8400  248.696  2.63953 -2.05283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  31:     3778.6436:  43.1351  260.296  2.59814 -1.87791</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  32:     3772.9536:  41.4752  235.934  2.57375 -1.92085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  33:     3772.1120:  41.3211  228.291  2.60112 -1.93531</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34:     3772.0141:  41.4141  228.973  2.60547 -1.95278</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  35:     3771.4779:  45.7515  236.710  2.61740 -2.00955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  36:     3770.4104:  58.6265  256.986  2.63126 -2.08453</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  37:     3767.2135:  107.441  330.688  2.65901 -2.26742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  38:     3760.1266:  242.336  530.117  2.69961 -2.66377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  39:     3746.3078:  608.548  1069.34  2.74263 -3.65099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  40:     3737.6921:  972.726  1609.93  2.70580 -4.52469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  41:     3737.3458:  1050.31  1727.02  2.69231 -4.69658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  42:     3737.3369:  1053.92  1732.83  2.69501 -4.70742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  43:     3737.3357:  1052.17  1730.60  2.69494 -4.70071</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  44:     3737.3356:  1052.78  1731.53  2.69491 -4.70114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  45:     3737.3345:  1055.23  1735.27  2.69476 -4.69771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  46:     3737.3318:  1059.01  1741.04  2.69451 -4.67925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  47:     3737.3237:  1065.96  1751.67  2.69397 -4.60911</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  48:     3737.2788:  1087.59  1784.82  2.69204 -4.27413</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  49:     3734.9657:  1174.02  1917.48  2.68374 -2.78196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  50:     3732.5797:  1208.59  1970.55  2.67256 -2.18511</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  51:     3728.9368:  1219.06  1986.62  2.57594 -1.99915</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  52:     3728.7881:  1222.13  1991.33  2.58184 -1.93498</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  53:     3728.7660:  1225.20  1996.03  2.54905 -1.88627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  54:     3728.6684:  1223.68  1993.67  2.56151 -1.89732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  55:     3728.6452:  1222.16  1991.31  2.56373 -1.91402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  56:     3728.1504:  1198.13  1953.29  2.55439 -1.90159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  57:     3727.1443:  1112.69  1820.90  2.56337 -1.90666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  58:     3726.9649:  1043.92  1717.10  2.55323 -1.88191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  59:     3726.9565:  1049.61  1725.43  2.55810 -1.89015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  60:     3726.9564:  1049.86  1725.86  2.55765 -1.88928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  61:     3726.9564:  1049.82  1725.79  2.55765 -1.88929</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimization done (0.051min). Model converged. Estimating uncertainty.</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/tokami" class="external-link">Tobias Mildenberger</a>, <a href="https://github.com/fishfollower" class="external-link">Anders Nielsen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

